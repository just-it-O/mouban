<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, 1.0">
    <title>陈鑫的请假</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#59a5f0',
                        secondary: '#4cd964',
                        neutral: '#f5f5f5',
                        textDark: '#333333',
                        textMedium: '#666666',
                        textLight: '#999999',
                    },
                    fontFamily: {
                        sans: ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const leaveData = JSON.parse(localStorage.getItem('leaveData'));
            if (leaveData && leaveData.name) {
                document.getElementById('leaveTitle').textContent = `${leaveData.name}的请假`;
                document.getElementById('mainTitle').textContent = `${leaveData.name}的请假`;
            }
        });
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            @keyframes spin-slow {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
            .animate-spin-slow {
                animation: spin-slow 5s linear infinite;
            }
            .content-auto {
                content-visibility: auto;
            }
            .border-b-dashed {
                border-bottom-style: dashed;
            }
            .progress-line {
                height: 40px;
                width: 2px;
                background-color: #4cd964;
                margin-left: 14px;
                margin-top: 2px;
            }
            .approval-stamp {
                position: fixed;
                top: 55px;
                right: 4px;
                width: 88px;
                height: 88px;
                z-index: 999;
            }
            .approval-stamp img:first-child {
                width: 100%;
                height: 100%;
                object-fit: contain;
            }
            .approval-stamp .star-container {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                animation: spin-slow 5s linear infinite;
            }
            /* 调整五角星的大小，这里将宽度和高度修改为 48px，你可以根据需要调整 */
            .approval-stamp .star-container img {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 86px;
                height: 86px;
                object-fit: contain;
            }
        }
        /* 调整蓝色长方形样式 */
        h2::before {
            content: "";
            display: inline-block;
            vertical-align: middle;
            height: 0.95em;
            width: 5px;
            background-color: #93c0ee;
            margin-right: 8px;
            margin-top: -1px;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <!-- 顶部导航栏 -->
    <header class="fixed top-0 left-0 w-full bg-primary text-white h-14 flex items-center justify-center px-4 z-50 shadow-md">
        <div class="absolute left-4 flex items-center space-x-4">
            <i class="fa fa-arrow-left text-xl"></i>
            <i class="fa fa-times text-xl"></i>
        </div>
        <span class="text-lg font-medium" id="leaveTitle">陈鑫的请假</span>
        <div class="absolute right-4 flex items-center space-x-4">
            <i class="fa fa-ellipsis-h text-xl"></i>
        </div>
    </header>
    <!-- 主内容区域 -->
    <main class="pt-14 pb-16">
        <!-- 标题部分 -->
        <section class="bg-white p-4 relative border-b border-gray-200">
            <h1 class="text-lg font-medium text-center text-textDark" id="mainTitle">陈鑫的请假</h1>
            <div class="approval-stamp">
                <img src="star.png" alt="审批通过">
                <div class="star-container">
                    <img src="stars.png" alt="五角星">
                </div>
            </div>
        </section>
        <!-- 申请人信息 -->
        <section class="bg-white my-3 p-4">
            <h2 class="text-textDark font-semibold mb-3">申请人</h2>
            <div class="text-textMedium pl-8 space-y-4" style="padding-left: 0em;">
                <div class="flex items-center py-2 border-b border-gray-100">
                    <span class="w-24" style="text-align: right;">姓名</span><span class="inline-block w-8" style="vertical-align:baseline;margin-top:-2px"></span>
                    <span id="applicantInfo"></span>
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            const leaveData = JSON.parse(localStorage.getItem('leaveData'));
            if (leaveData && leaveData.startTime) {
                const date = new Date(leaveData.startTime);
const formattedTime = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
document.getElementById('reminderTime').textContent = formattedTime;
            }
            if (leaveData && leaveData.startTime) {
                const date = new Date(leaveData.startTime);
const formattedTime = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
document.getElementById('reminderTime').textContent = formattedTime;
            }
                            if (leaveData) {
                                document.getElementById('applicantInfo').textContent = `${leaveData.name}(${leaveData.studentId})`;
                            }
                        });
                    </script>
                </div>
            </div>
        </section>
        <!-- 申请内容 -->
        <section class="bg-white my-3 p-4">
            <h2 class="text-textDark font-semibold mb-3">申请内容</h2>
            <div class="text-textMedium pl-8 space-y-4" style="padding-left: 1.8em;">
                <div class="flex items-center py-2 border-b border-gray-100">
                    <span class="w-24">审批编号</span>
                    <span>20250424112934886466</span>
                </div>
                <div class="flex items-center py-2 border-b border-gray-100">
                    <span class="w-24">是否离校</span>
                    <span>是</span>
                </div>
                <div class="flex items-center py-2 border-b border-gray-100">
                    <span class="w-24">开始时间</span>
                    <span data-time="start">2025-04-24 17:00</span>
                </div>
                <div class="flex items-center py-2 border-b border-gray-100">
                    <span class="w-24">结束时间</span>
                    <span data-time="end">2025-04-24 20:00</span>
                </div>
                <div class="flex items-center py-2 border-b border-gray-100">
                    <span class="w-24">时长(天)</span>
                    <span>0.5</span>
                </div>
                <div class="flex items-center py-2 border-b border-gray-100">
                    <span class="w-24">请假类型</span>
                    <span>其他</span>
                </div>
                <div class="flex items-center py-2 border-b border-gray-100">
                    <span class="w-24">本人联系电<br style="display:block;margin-top:-0.5em">话</span>
                    <span>15772792298</span>
                </div>
                <div class="flex items-center py-2 border-b border-gray-100">
                    <span class="w-24">紧急联系人</span>
                    <span>尹汉芬</span>
                </div>
                <div class="flex items-center py-2 border-b border-gray-100">
                    <span class="w-24">紧急联系电<br style="display:block;margin-top:-0.5em">话</span>
                    <span>15117647928</span>
                </div>
                <div class="flex items-start py-2 border-b border-gray-100">
                    <span class="w-24 pt-1">请假原因</span>
                    <span>外出去清镇第一人民医院体检 身体最近有不适 以争得家长同意</span>
                </div>
                <div class="flex items-center py-2 border-b border-gray-100">
                    <span class="w-24">请假去向</span>
                    <span>清镇市第一人民医院</span>
                </div>
                <div class="flex items-center py-2">
                    <div class="flex space-x-2" id="evidenceImages">
                        <script>
                            document.addEventListener('DOMContentLoaded', function() {
                                const leaveData = JSON.parse(localStorage.getItem('leaveData'));
            if (leaveData && leaveData.startTime) {
                const date = new Date(leaveData.startTime);
const formattedTime = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
document.getElementById('reminderTime').textContent = formattedTime;
            }
            if (leaveData && leaveData.startTime) {
                const date = new Date(leaveData.startTime);
const formattedTime = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
document.getElementById('reminderTime').textContent = formattedTime;
            }
                                if (leaveData && leaveData.images && leaveData.images.length > 0) {
                                    const container = document.getElementById('evidenceImages');
                                    const label = document.createElement('span');
                                    label.className = 'w-24';
                                    label.textContent = '佐证材料';
                                    container.parentNode.insertBefore(label, container);
                                    leaveData.images.forEach(image => {
                                        const img = document.createElement('img');
                                        img.src = image;
                                        img.alt = '佐证材料';
                                        img.classList.add('w-16', 'h-16', 'object-cover', 'rounded');
                                        container.appendChild(img);
                                    });
                                } else {
                                    container.parentNode.style.display = 'none';
                                }
                            });
                        </script>
                    </div>
                </div>
            </div>
        </section>
        <!-- 审批进度 -->
        <section class="bg-white my-3 p-4">
            <h2 class="text-textDark font-semibold mb-3">审批进度</h2>
            <div class="flex">
                <div class="mr-3">
                    <div class="w-7 h-7 bg-secondary rounded-full flex items-center justify-center text-white text-sm">1</div>
                    <div class="progress-line"></div>
                </div>
                <div class="flex-1">
                    <div class="flex justify-between">
                        <div class="text-textDark font-medium">谢磊(122024010)</div>
                        <div class="text-textLight text-sm" id="approvalTime">2025-04-24 17:00</div>
                        <script>
                            document.addEventListener('DOMContentLoaded', function() {
                                const leaveData = JSON.parse(localStorage.getItem('leaveData'));
            if (leaveData && leaveData.startTime) {
                const date = new Date(leaveData.startTime);
const formattedTime = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
document.getElementById('reminderTime').textContent = formattedTime;
            }
            if (leaveData && leaveData.startTime) {
                const date = new Date(leaveData.startTime);
const formattedTime = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
document.getElementById('reminderTime').textContent = formattedTime;
            }
                                if (leaveData && leaveData.startTime) {
                                    const startDate = new Date(leaveData.startTime);
                                    const formattedTime = `${startDate.getFullYear()}-${String(startDate.getMonth() + 1).padStart(2, '0')}-${String(startDate.getDate()).padStart(2, '0')} ${String(startDate.getHours()).padStart(2, '0')}:${String(startDate.getMinutes()).padStart(2, '0')}`;
                                    document.getElementById('approvalTime').textContent = formattedTime;
                                }
                            });
                        </script>
                        <script>
                            document.addEventListener('DOMContentLoaded', function() {
                                const leaveData = JSON.parse(localStorage.getItem('leaveData'));
            if (leaveData && leaveData.startTime) {
                const date = new Date(leaveData.startTime);
const formattedTime = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
document.getElementById('reminderTime').textContent = formattedTime;
            }
            if (leaveData && leaveData.startTime) {
                const date = new Date(leaveData.startTime);
const formattedTime = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
document.getElementById('reminderTime').textContent = formattedTime;
            }
                                if (leaveData) {
                                    // 处理申请人信息
                                    document.getElementById('applicantInfo').textContent = `${leaveData.name}(${leaveData.studentId})`;
                                    
                                    // 处理时间显示
                                    if (leaveData.startTime) {
                                        const startDate = new Date(leaveData.startTime);
                                        const formattedStartTime = `${startDate.getFullYear()}-${String(startDate.getMonth() + 1).padStart(2, '0')}-${String(startDate.getDate()).padStart(2, '0')} ${String(startDate.getHours()).padStart(2, '0')}:${String(startDate.getMinutes()).padStart(2, '0')}`;
                                        document.querySelector('[data-time="start"]').textContent = formattedStartTime;
                                    }
                                    if (leaveData.endTime) {
                                        const endDate = new Date(leaveData.endTime);
                                        const formattedEndTime = `${endDate.getFullYear()}-${String(endDate.getMonth() + 1).padStart(2, '0')}-${String(endDate.getDate()).padStart(2, '0')} ${String(endDate.getHours()).padStart(2, '0')}:${String(endDate.getMinutes()).padStart(2, '0')}`;
                                        document.querySelector('[data-time="end"]').textContent = formattedEndTime;
                                    }
                                }
                            });
                        </script>
                    </div>
                    <div class="text-green-600 text-sm mt-1">已同意</div>
                    <div class="flex items-center mt-2">
                        <span class="text-green-600 text-sm">通过</span>
                        <span class="bg-gray-200 text-textLight text-xs px-2 py-1 rounded ml-2">已催办</span><span class="text-secondary text-xs ml-2" id="reminderTime"></span><span class="text-secondary text-xs ml-2" id="reminderTime"></span>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <!-- 底部操作区 -->
    <footer class="fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 py-3 px-4 flex justify-center">
        <button class="bg-white text-[#59a5f0] rounded-lg py-2 px-4 w-full font-medium border border-gray-200">
            转发审批表单
        </button>
    </footer>
    <script>
        // 从localStorage读取数据并更新页面内容
        const leaveData = JSON.parse(localStorage.getItem('leaveData'));
            if (leaveData && leaveData.startTime) {
                const date = new Date(leaveData.startTime);
const formattedTime = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
document.getElementById('reminderTime').textContent = formattedTime;
            }
            if (leaveData && leaveData.startTime) {
                const date = new Date(leaveData.startTime);
const formattedTime = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
document.getElementById('reminderTime').textContent = formattedTime;
            }
        if (leaveData) {
            // 更新标题
            document.querySelector('title').textContent = `${leaveData.name}的请假`;
            document.querySelector('header span').textContent = `${leaveData.name}的请假`;
            document.querySelector('h1').textContent = `${leaveData.name}的请假`;
            // 更新申请内容
            const fields = ['startTime', 'endTime', 'phone', 'emergencyContact', 'emergencyPhone', 'reason', 'destination'];
            const selectors = [
                '开始时间',
                '结束时间',
                '本人联系电话',
                '紧急联系人',
                '紧急联系电话',
                '请假原因',
                '请假去向'
            ];
            fields.forEach((field, index) => {
                const element = Array.from(document.querySelectorAll('.text-textMedium span'))
                    .find(el => el.previousElementSibling?.textContent === selectors[index]);
                if (element) {
                    element.textContent = leaveData[field];
                }
            });
            // 更新审批进度中的辅导员姓名
            const counselorElement = document.querySelector('.text-textDark.font-medium');
            if (counselorElement) {
                counselorElement.textContent = `${leaveData.counselor}(122024010)`;
            }
        }
        // 导航栏交互
        document.querySelector('.fa-arrow-left').addEventListener('click', function() {
            window.history.back();
        });
        // 底部按钮交互
        document.querySelector('footer button').addEventListener('click', function() {
            alert('转发功能已触发');
        });
    </script>
</body>
</html>
